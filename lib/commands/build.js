"use strict";var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.handler=exports.desc=exports.command=void 0;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator"));var _asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));var _log=_interopRequireWildcard(require("../utils/log"));var _init=require("../utils/init");var _webpack=_interopRequireDefault(require("webpack"));var _webpackDevServer=_interopRequireDefault(require("webpack-dev-server"));var _config=require("../config");var _extra=require("../utils/extra");var _options=_interopRequireDefault(require("../source/options"));var command="build";exports.command=command;var desc="-- build deploy";exports.desc=desc;var handler=/*#__PURE__*/function(){var _ref=(0,_asyncToGenerator2.default)(/*#__PURE__*/_regenerator.default.mark(function _callee3(){return _regenerator.default.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return(0,_log.spinner)("start webpack",/*#__PURE__*/function(){var _ref2=(0,_asyncToGenerator2.default)(/*#__PURE__*/_regenerator.default.mark(function _callee2(spinner){return _regenerator.default.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:return _context2.abrupt("return",new Promise(function(resolve,reject){var opt=Object.assign((0,_extra.getUserConfig)(),_options.default,{mode:"production"});var WebpackConfig=(0,_config.getConfig)(opt);var compiler=(0,_webpack.default)(WebpackConfig,function(err,stats){if(err||stats.hasErrors()){return reject(stats.toString({chunks:false,children:false,modules:false,colors:true}))}console.log(stats.toString({chunks:false,children:false,modules:false,colors:true}));resolve()});compiler.hooks.done.tapPromise("anything",/*#__PURE__*/(0,_asyncToGenerator2.default)(/*#__PURE__*/_regenerator.default.mark(function _callee(){return _regenerator.default.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:spinner.clear();case 1:case"end":return _context.stop();}}},_callee,this)})))}));case 1:case"end":return _context2.stop();}}},_callee2,this)}));return function(_x){return _ref2.apply(this,arguments)}}());case 2:case"end":return _context3.stop();}}},_callee3,this)}));return function handler(){return _ref.apply(this,arguments)}}();exports.handler=handler;